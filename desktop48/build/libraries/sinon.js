this.sinon=function(){var samsam,formatio;function define(t,e,n){"samsam"==t?samsam=e():formatio=n(samsam)}define.amd=!0,("function"==typeof define&&define.amd&&function(t){define("samsam",t)}||"object"==typeof module&&function(t){module.exports=t()}||function(t){this.samsam=t()})(function(){var s,R=Object.prototype,e="undefined"!=typeof document&&document.createElement("div");function M(t){return"number"==typeof t&&t!==t}function I(t){return R.toString.call(t).split(/[ \]]/)[1]}function L(t){if("object"!=typeof t||"number"!=typeof t.length||"Array"===I(t))return!1;if("function"==typeof t.callee)return!0;try{t[t.length]=6,delete t[t.length]}catch(t){return!0}return!1}function P(t){if(!t||1!==t.nodeType||!e)return!1;try{t.appendChild(e),t.removeChild(e)}catch(t){return!1}return!0}function H(t){var e,n=[];for(e in t)R.hasOwnProperty.call(t,e)&&n.push(e);return n}function N(t){return"function"==typeof t.getTime&&t.getTime()==t.valueOf()}function n(t){return 0===t&&1/t==-1/0}function F(t,e){if(t===e||M(t)&&M(e))return 0!==t||n(t)===n(e)}return{isArguments:L,isElement:P,isDate:N,isNegZero:n,identical:F,deepEqual:function(t,e){var A=[],k=[],T=[],S=[],O={};function j(t){return!("object"!=typeof t||null===t||t instanceof Boolean||t instanceof Date||t instanceof Number||t instanceof RegExp||t instanceof String)}function q(t,e){var n;for(n=0;n<t.length;n++)if(t[n]===e)return n;return-1}return function t(e,n,r,i){var o=typeof e,s=typeof n;if(e===n||M(e)||M(n)||null==e||null==n||"object"!==o||"object"!==s)return F(e,n);if(P(e)||P(n))return!1;var a=N(e),l=N(n);if((a||l)&&(!a||!l||e.getTime()!==n.getTime()))return!1;if(e instanceof RegExp&&n instanceof RegExp&&e.toString()!==n.toString())return!1;var c,u,h,f,p,d,y,m,g,v,w,b=I(e),x=I(n),C=H(e),E=H(n);if(L(e)||L(n)){if(e.length!==n.length)return!1}else if(o!==s||b!==x||C.length!==E.length)return!1;for(u=0,h=C.length;u<h;u++){if(c=C[u],!R.hasOwnProperty.call(n,c))return!1;if(f=e[c],p=n[c],d=j(f),y=j(p),m=d?q(A,f):-1,g=y?q(k,p):-1,v=-1!==m?T[m]:r+"["+JSON.stringify(c)+"]",w=-1!==g?S[g]:i+"["+JSON.stringify(c)+"]",O[v+w])return!0;if(-1===m&&d&&(A.push(f),T.push(v)),-1===g&&y&&(k.push(p),S.push(w)),d&&y&&(O[v+w]=!0),!t(f,p,v,w))return!1}return!0}(t,e,"$1","$2")},match:s=function t(e,n){if(n&&"function"==typeof n.test)return n.test(e);if("function"==typeof n)return!0===n(e);if("string"==typeof n)return n=n.toLowerCase(),("string"==typeof e||!!e)&&0<=String(e).toLowerCase().indexOf(n);if("number"==typeof n)return n===e;if("boolean"==typeof n)return n===e;if("Array"===I(e)&&"Array"===I(n))return function(t,e){if(0===e.length)return!0;var n,r,i,o;for(n=0,r=t.length;n<r;++n)if(s(t[n],e[0])){for(i=0,o=e.length;i<o;++i)if(!s(t[n+i],e[i]))return!1;return!0}return!1}(e,n);if(n&&"object"==typeof n){var r;for(r in n)if(!t(e[r],n[r]))return!1;return!0}throw new Error("Matcher was not a string, a number, a function, a boolean or an object")},keys:H}}),("function"==typeof define&&define.amd&&function(t){define("formatio",["samsam"],t)}||"object"==typeof module&&function(t){module.exports=t(require("samsam"))}||function(t){this.formatio=t(this.samsam)})(function(d){var s={excludeConstructors:["Object",/^.$/],quoteStrings:!0},a=(Object.prototype.hasOwnProperty,[]);function l(t){if(!t)return"";if(t.displayName)return t.displayName;if(t.name)return t.name;var e=t.toString().match(/function\s+([^\(]+)/m);return e&&e[1]||""}function y(t,e){var n,r,i=l(e&&e.constructor),o=t.excludeConstructors||s.excludeConstructors||[];for(n=0,r=o.length;n<r;++n){if("string"==typeof o[n]&&o[n]===i)return"";if(o[n].test&&o[n].test(i))return""}return i}function m(t,e){if("object"!=typeof t)return!1;var n,r;for(n=0,r=e.length;n<r;++n)if(e[n]===t)return!0;return!1}function g(t,e,n,r){if("string"==typeof e){var i=t.quoteStrings;return n||("boolean"!=typeof i||i)?'"'+e+'"':e}if("function"==typeof e&&!(e instanceof RegExp))return g.func(e);if(m(e,n=n||[]))return"[Circular]";if("[object Array]"===Object.prototype.toString.call(e))return g.array.call(t,e,n);if(!e)return String(1/e==-1/0?"-0":e);if(d.isElement(e))return g.element(e);if("function"==typeof e.toString&&e.toString!==Object.prototype.toString)return e.toString();var o,s;for(o=0,s=a.length;o<s;o++)if(e===a[o].object)return a[o].value;return g.object.call(t,e,n,r)}function e(t){for(var e in t)this[e]=t[e]}return"undefined"!=typeof global&&a.push({object:global,value:"[object global]"}),"undefined"!=typeof document&&a.push({object:document,value:"[object HTMLDocument]"}),"undefined"!=typeof window&&a.push({object:window,value:"[object Window]"}),g.func=function(t){return"function "+l(t)+"() {}"},g.array=function(t,e){(e=e||[]).push(t);var n,r,i=[];for(n=0,r=t.length;n<r;++n)i.push(g(this,t[n],e));return"["+i.join(", ")+"]"},g.object=function(t,e,n){(e=e||[]).push(t),n=n||0;var r,i,o,s,a,l=[],c=d.keys(t).sort(),u=3;for(s=0,a=c.length;s<a;++s)i=m(o=t[r=c[s]],e)?"[Circular]":g(this,o,e,n+2),u+=(i=(/\s/.test(r)?'"'+r+'"':r)+": "+i).length,l.push(i);var h=y(this,t),f=h?"["+h+"] ":"",p="";for(s=0,a=n;s<a;++s)p+=" ";return 80<u+n?f+"{\n  "+p+l.join(",\n  "+p)+"\n"+p+"}":f+"{ "+l.join(", ")+" }"},g.element=function(t){var e,n,r,i,o,s=t.tagName.toLowerCase(),a=t.attributes,l=[];for(r=0,i=a.length;r<i;++r)n=(e=a.item(r)).nodeName.toLowerCase().replace("html:",""),o=e.nodeValue,"contenteditable"===n&&"inherit"===o||o&&l.push(n+'="'+o+'"');var c="<"+s+(0<l.length?" ":""),u=t.innerHTML;return 20<u.length&&(u=u.substr(0,20)+"[...]"),(c+l.join(" ")+">"+u+"</"+s+">").replace(/ contentEditable="inherit"/,"")},e.prototype={functionName:l,configure:function(t){return new e(t)},constructorName:function(t){return y(this,t)},ascii:function(t,e,n){return g(this,t,e,n)}}});var sinon=function(t){var n="undefined"!=typeof document&&document.createElement("div"),l=Object.prototype.hasOwnProperty;function a(t){return n&&t&&1===t.nodeType&&function(t){var e=!1;try{t.appendChild(n),e=n.parentNode==t}catch(t){return!1}finally{try{t.removeChild(n)}catch(t){}}return e}(t)}function r(t){return"function"==typeof t&&"function"==typeof t.restore&&t.restore.sinon}var c={wrapMethod:function(t,e,n){if(!t)throw new TypeError("Should wrap property of object");if("function"!=typeof n)throw new TypeError("Method wrapper should be function");var r,i,o=t[e];if("function"==typeof(i=o)||i&&i.constructor&&i.call&&i.apply||(r=new TypeError("Attempted to wrap "+typeof o+" property "+e+" as function")),o.restore&&o.restore.sinon&&(r=new TypeError("Attempted to wrap "+e+" which is already wrapped")),o.calledBefore){var s=o.returns?"stubbed":"spied on";r=new TypeError("Attempted to wrap "+e+" which is already "+s)}if(r)throw o._stack&&(r.stack+="\n--------------\n"+o._stack),r;var a=t.hasOwnProperty?t.hasOwnProperty(e):l.call(t,e);return(t[e]=n).displayName=e,n._stack=new Error("Stack Trace for original").stack,n.restore=function(){a||delete t[e],t[e]===n&&(t[e]=o)},n.restore.sinon=!0,function(t,e){for(var n in e)l.call(t,n)||(t[n]=e[n])}(n,o),n},extend:function(t){for(var e=1,n=arguments.length;e<n;e+=1)for(var r in arguments[e])arguments[e].hasOwnProperty(r)&&(t[r]=arguments[e][r]),arguments[e].hasOwnProperty("toString")&&arguments[e].toString!=t.toString&&(t.toString=arguments[e].toString);return t},create:function(t){var e=function(){};return e.prototype=t,new e},deepEqual:function t(e,n){if(c.match&&c.match.isMatcher(e))return e.test(n);if("object"!=typeof e||"object"!=typeof n)return e===n;if(a(e)||a(n))return e===n;if(e===n)return!0;if(null===e&&null!==n||null!==e&&null===n)return!1;var r=Object.prototype.toString.call(e);if(r!=Object.prototype.toString.call(n))return!1;if("[object Date]"==r)return e.valueOf()===n.valueOf();var i,o=0,s=0;if("[object Array]"==r&&e.length!==n.length)return!1;for(i in e)if(o+=1,!t(e[i],n[i]))return!1;for(i in n)s+=1;return o==s},functionName:function(t){var e=t.displayName||t.name;if(!e){var n=t.toString().match(/function ([^\s\(]+)/);e=n&&n[1]}return e},functionToString:function(){if(this.getCall&&this.callCount)for(var t,e,n=this.callCount;n--;)for(e in t=this.getCall(n).thisValue)if(t[e]===this)return e;return this.displayName||"sinon fake"},getConfig:function(t){var e={};t=t||{};var n=c.defaultConfig;for(var r in n)n.hasOwnProperty(r)&&(e[r]=t.hasOwnProperty(r)?t[r]:n[r]);return e},format:function(t){return""+t},defaultConfig:{injectIntoThis:!0,injectInto:null,properties:["spy","stub","mock","clock","server","requests"],useFakeTimers:!0,useFakeServer:!0},timesInWords:function(t){return(1==t?"once":2==t&&"twice")||3==t&&"thrice"||(t||0)+" times"},calledInOrder:function(t){for(var e=1,n=t.length;e<n;e++)if(!t[e-1].calledBefore(t[e])||!t[e].called)return!1;return!0},orderByFirstCall:function(t){return t.sort(function(t,e){var n=t.getCall(0),r=e.getCall(0);return(n&&n.callId||-1)<(r&&r.callId||-1)?-1:1})},log:function(){},logError:function(t,e){var n=t+" threw exception: ";c.log(n+"["+e.name+"] "+e.message),e.stack&&c.log(e.stack),setTimeout(function(){throw e.message=n+e.message,e},0)},typeOf:function(t){if(null===t)return"null";if(void 0===t)return"undefined";var e=Object.prototype.toString.call(t);return e.substring(8,e.length-1).toLowerCase()},createStubInstance:function(t){if("function"!=typeof t)throw new TypeError("The constructor should be a function.");return c.stub(c.create(t.prototype))},restore:function(t){if(null!==t&&"object"==typeof t)for(var e in t)r(t[e])&&t[e].restore();else r(t)&&t.restore()}},e="undefined"!=typeof module&&module.exports;if("function"==typeof define&&"object"==typeof define.amd&&define.amd)define(function(){return c});else if(e){try{t=require("formatio")}catch(t){}module.exports=c,module.exports.spy=require("./sinon/spy"),module.exports.spyCall=require("./sinon/call"),module.exports.behavior=require("./sinon/behavior"),module.exports.stub=require("./sinon/stub"),module.exports.mock=require("./sinon/mock"),module.exports.collection=require("./sinon/collection"),module.exports.assert=require("./sinon/assert"),module.exports.sandbox=require("./sinon/sandbox"),module.exports.test=require("./sinon/test"),module.exports.testCase=require("./sinon/test_case"),module.exports.assert=require("./sinon/assert"),module.exports.match=require("./sinon/match")}if(t){var i=t.configure({quoteStrings:!1});c.format=function(){return i.ascii.apply(i,arguments)}}else if(e)try{var o=require("util");c.format=function(t){return"object"==typeof t&&t.toString===Object.prototype.toString?o.inspect(t):t}}catch(t){}return c}("object"==typeof formatio&&formatio),em;if(function(s){var t="undefined"!=typeof module&&module.exports;if(!s&&t&&(s=require("../sinon")),s){var o={toString:function(){return this.message},or:function(e){if(!r(e))throw new TypeError("Matcher expected");var n=this,t=s.create(o);return t.test=function(t){return n.test(t)||e.test(t)},t.message=n.message+".or("+e.message+")",t},and:function(e){if(!r(e))throw new TypeError("Matcher expected");var n=this,t=s.create(o);return t.test=function(t){return n.test(t)&&e.test(t)},t.message=n.message+".and("+e.message+")",t}},a=function(e,t){var n=s.create(o);switch(s.typeOf(e)){case"object":if("function"==typeof e.test)return n.test=function(t){return!0===e.test(t)},n.message="match("+s.functionName(e.test)+")",n;var r=[];for(var i in e)e.hasOwnProperty(i)&&r.push(i+": "+e[i]);n.test=function(t){return function t(e,n){if(null==n)return!1;for(var r in e)if(e.hasOwnProperty(r)){var i=e[r],o=n[r];if(a.isMatcher(i)){if(!i.test(o))return!1}else if("object"===s.typeOf(i)){if(!t(i,o))return!1}else if(!s.deepEqual(i,o))return!1}return!0}(e,t)},n.message="match("+r.join(", ")+")";break;case"number":n.test=function(t){return e==t};break;case"string":n.test=function(t){return"string"==typeof t&&-1!==t.indexOf(e)},n.message='match("'+e+'")';break;case"regexp":n.test=function(t){return"string"==typeof t&&e.test(t)};break;case"function":n.test=e,n.message=t||"match("+s.functionName(e)+")";break;default:n.test=function(t){return s.deepEqual(e,t)}}return n.message||(n.message="match("+e+")"),n};a.isMatcher=r,a.any=a(function(){return!0},"any"),a.defined=a(function(t){return null!=t},"defined"),a.truthy=a(function(t){return!!t},"truthy"),a.falsy=a(function(t){return!t},"falsy"),a.same=function(e){return a(function(t){return e===t},"same("+e+")")},a.typeOf=function(e){return l(e,"string","type"),a(function(t){return s.typeOf(t)===e},'typeOf("'+e+'")')},a.instanceOf=function(e){return l(e,"function","type"),a(function(t){return t instanceof e},"instanceOf("+s.functionName(e)+")")},a.has=e(function(t,e){return"object"==typeof t?e in t:void 0!==t[e]},"has"),a.hasOwn=e(function(t,e){return t.hasOwnProperty(e)},"hasOwn"),a.bool=a.typeOf("boolean"),a.number=a.typeOf("number"),a.string=a.typeOf("string"),a.object=a.typeOf("object"),a.func=a.typeOf("function"),a.array=a.typeOf("array"),a.regexp=a.typeOf("regexp"),a.date=a.typeOf("date"),t?module.exports=a:s.match=a}function l(t,e,n){var r=s.typeOf(t);if(r!==e)throw new TypeError("Expected type of "+n+" to be "+e+", but was "+r)}function r(t){return o.isPrototypeOf(t)}function e(i,o){return function(e,n){l(e,"string","property");var r=1===arguments.length,t=o+'("'+e+'"';return r||(t+=", "+n),a(function(t){return!(null==t||!i(t,e))&&(r||s.deepEqual(n,t[e]))},t+=")")}}}("object"==typeof sinon&&sinon||null),function(a){var t="undefined"!=typeof module&&module.exports;if(!a&&t&&(a=require("../sinon")),a){var o=Array.prototype.slice,l={calledOn:function(t){return a.match&&a.match.isMatcher(t)?t.test(this.thisValue):this.thisValue===t},calledWith:function(){for(var t=0,e=arguments.length;t<e;t+=1)if(!a.deepEqual(arguments[t],this.args[t]))return!1;return!0},calledWithMatch:function(){for(var t=0,e=arguments.length;t<e;t+=1){var n=this.args[t],r=arguments[t];if(!a.match||!a.match(r).test(n))return!1}return!0},calledWithExactly:function(){return arguments.length==this.args.length&&this.calledWith.apply(this,arguments)},notCalledWith:function(){return!this.calledWith.apply(this,arguments)},notCalledWithMatch:function(){return!this.calledWithMatch.apply(this,arguments)},returned:function(t){return a.deepEqual(t,this.returnValue)},threw:function(t){return void 0!==t&&this.exception?this.exception===t||this.exception.name===t:!!this.exception},calledWithNew:function(){return this.proxy.prototype&&this.thisValue instanceof this.proxy},calledBefore:function(t){return this.callId<t.callId},calledAfter:function(t){return this.callId>t.callId},callArg:function(t){this.args[t]()},callArgOn:function(t,e){this.args[t].apply(e)},callArgWith:function(t){this.callArgOnWith.apply(this,[t,null].concat(o.call(arguments,1)))},callArgOnWith:function(t,e){var n=o.call(arguments,2);this.args[t].apply(e,n)},yield:function(){this.yieldOn.apply(this,[null].concat(o.call(arguments,0)))},yieldOn:function(t){for(var e=this.args,n=0,r=e.length;n<r;++n)if("function"==typeof e[n])return void e[n].apply(t,o.call(arguments,1));s(this.proxy," cannot yield since no callback was passed.",e)},yieldTo:function(t){this.yieldToOn.apply(this,[t,null].concat(o.call(arguments,1)))},yieldToOn:function(t,e){for(var n=this.args,r=0,i=n.length;r<i;++r)if(n[r]&&"function"==typeof n[r][t])return void n[r][t].apply(e,o.call(arguments,2));s(this.proxy," cannot yield to '"+t+"' since no callback was passed.",n)},toString:function(){for(var t=this.proxy.toString()+"(",e=[],n=0,r=this.args.length;n<r;++n)e.push(a.format(this.args[n]));return t=t+e.join(", ")+")",void 0!==this.returnValue&&(t+=" => "+a.format(this.returnValue)),this.exception&&(t+=" !"+this.exception.name,this.exception.message&&(t+="("+this.exception.message+")")),t}};l.invokeCallback=l.yield,e.toString=l.toString,t?module.exports=e:a.spyCall=e}function s(t,e,n){var r=a.functionName(t)+e;throw n.length&&(r+=" Received ["+o.call(n).join(", ")+"]"),new Error(r)}function e(t,e,n,r,i,o){if("number"!=typeof o)throw new TypeError("Call id is not a number");var s=a.create(l);return s.proxy=t,s.thisValue=e,s.args=n,s.returnValue=r,s.exception=i,s.callId=o,s}}("object"==typeof sinon&&sinon||null),function(sinon){var commonJSModule="undefined"!=typeof module&&module.exports,push=Array.prototype.push,slice=Array.prototype.slice,callId=0;if(!sinon&&commonJSModule&&(sinon=require("../sinon")),sinon){var vars="a,b,c,d,e,f,g,h,i,j,k,l",uuid=0,spyApi={reset:function(){if(this.called=!1,this.notCalled=!0,this.calledOnce=!1,this.calledTwice=!1,this.calledThrice=!1,this.callCount=0,this.firstCall=null,this.secondCall=null,this.thirdCall=null,this.lastCall=null,this.args=[],this.returnValues=[],this.thisValues=[],this.exceptions=[],this.callIds=[],this.fakes)for(var t=0;t<this.fakes.length;t++)this.fakes[t].reset()},create:function(t){var e;"function"!=typeof t?t=function(){}:e=sinon.functionName(t);var n=createProxy(t);return sinon.extend(n,spy),delete n.create,sinon.extend(n,t),n.reset(),n.prototype=t.prototype,n.displayName=e||"spy",n.toString=sinon.functionToString,n._create=sinon.spy.create,n.id="spy#"+uuid++,n},invoke:function(t,e,n){var r,i,o=matchingFake(this.fakes,n);incrementCallCount.call(this),push.call(this.thisValues,e),push.call(this.args,n),push.call(this.callIds,callId++);try{i=o?o.invoke(t,e,n):(this.func||t).apply(e,n),this.getCall(this.callCount-1).calledWithNew()&&"object"!=typeof i&&(i=e)}catch(t){r=t}if(push.call(this.exceptions,r),push.call(this.returnValues,i),createCallProperties.call(this),void 0!==r)throw r;return i},getCall:function(t){return t<0||t>=this.callCount?null:sinon.spyCall(this,this.thisValues[t],this.args[t],this.returnValues[t],this.exceptions[t],this.callIds[t])},getCalls:function(){var t,e=[];for(t=0;t<this.callCount;t++)e.push(this.getCall(t));return e},calledBefore:function(t){return!!this.called&&(!t.called||this.callIds[0]<t.callIds[t.callIds.length-1])},calledAfter:function(t){return!(!this.called||!t.called)&&this.callIds[this.callCount-1]>t.callIds[t.callCount-1]},withArgs:function(){var t=slice.call(arguments);if(this.fakes){var e=matchingFake(this.fakes,t,!0);if(e)return e}else this.fakes=[];var n=this,r=this._create();r.matchingAguments=t,r.parent=this,push.call(this.fakes,r),r.withArgs=function(){return n.withArgs.apply(n,arguments)};for(var i=0;i<this.args.length;i++)r.matches(this.args[i])&&(incrementCallCount.call(r),push.call(r.thisValues,this.thisValues[i]),push.call(r.args,this.args[i]),push.call(r.returnValues,this.returnValues[i]),push.call(r.exceptions,this.exceptions[i]),push.call(r.callIds,this.callIds[i]));return createCallProperties.call(r),r},matches:function(t,e){var n=this.matchingAguments;if(n.length<=t.length&&sinon.deepEqual(n,t.slice(0,n.length)))return!e||n.length==t.length},printf:function(t){var n,r=this,i=slice.call(arguments,1);return(t||"").replace(/%(.)/g,function(t,e){return"function"==typeof(n=spyApi.formatters[e])?n.call(null,r,i):isNaN(parseInt(e,10))?"%"+e:sinon.format(i[e-1])})}};delegateToCalls("calledOn",!0),delegateToCalls("alwaysCalledOn",!1,"calledOn"),delegateToCalls("calledWith",!0),delegateToCalls("calledWithMatch",!0),delegateToCalls("alwaysCalledWith",!1,"calledWith"),delegateToCalls("alwaysCalledWithMatch",!1,"calledWithMatch"),delegateToCalls("calledWithExactly",!0),delegateToCalls("alwaysCalledWithExactly",!1,"calledWithExactly"),delegateToCalls("neverCalledWith",!1,"notCalledWith",function(){return!0}),delegateToCalls("neverCalledWithMatch",!1,"notCalledWithMatch",function(){return!0}),delegateToCalls("threw",!0),delegateToCalls("alwaysThrew",!1,"threw"),delegateToCalls("returned",!0),delegateToCalls("alwaysReturned",!1,"returned"),delegateToCalls("calledWithNew",!0),delegateToCalls("alwaysCalledWithNew",!1,"calledWithNew"),delegateToCalls("callArg",!1,"callArgWith",function(){throw new Error(this.toString()+" cannot call arg since it was not yet invoked.")}),spyApi.callArgWith=spyApi.callArg,delegateToCalls("callArgOn",!1,"callArgOnWith",function(){throw new Error(this.toString()+" cannot call arg since it was not yet invoked.")}),spyApi.callArgOnWith=spyApi.callArgOn,delegateToCalls("yield",!1,"yield",function(){throw new Error(this.toString()+" cannot yield since it was not yet invoked.")}),spyApi.invokeCallback=spyApi.yield,delegateToCalls("yieldOn",!1,"yieldOn",function(){throw new Error(this.toString()+" cannot yield since it was not yet invoked.")}),delegateToCalls("yieldTo",!1,"yieldTo",function(t){throw new Error(this.toString()+" cannot yield to '"+t+"' since it was not yet invoked.")}),delegateToCalls("yieldToOn",!1,"yieldToOn",function(t){throw new Error(this.toString()+" cannot yield to '"+t+"' since it was not yet invoked.")}),spyApi.formatters={c:function(t){return sinon.timesInWords(t.callCount)},n:function(t){return t.toString()},C:function(t){for(var e=[],n=0,r=t.callCount;n<r;++n){var i="    "+t.getCall(n).toString();/\n/.test(e[n-1])&&(i="\n"+i),push.call(e,i)}return 0<e.length?"\n"+e.join("\n"):""},t:function(t){for(var e=[],n=0,r=t.callCount;n<r;++n)push.call(e,sinon.format(t.thisValues[n]));return e.join(", ")},"*":function(t,e){for(var n=[],r=0,i=e.length;r<i;++r)push.call(n,sinon.format(e[r]));return n.join(", ")}},sinon.extend(spy,spyApi),spy.spyCall=sinon.spyCall,commonJSModule?module.exports=spy:sinon.spy=spy}function spy(t,e){if(!e&&"function"==typeof t)return spy.create(t);if(!t&&!e)return spy.create(function(){});var n=t[e];return sinon.wrapMethod(t,e,spy.create(n))}function matchingFake(t,e,n){if(t)for(var r=0,i=t.length;r<i;r++)if(t[r].matches(e,n))return t[r]}function incrementCallCount(){this.called=!0,this.callCount+=1,this.notCalled=!1,this.calledOnce=1==this.callCount,this.calledTwice=2==this.callCount,this.calledThrice=3==this.callCount}function createCallProperties(){this.firstCall=this.getCall(0),this.secondCall=this.getCall(1),this.thirdCall=this.getCall(2),this.lastCall=this.getCall(this.callCount-1)}function createProxy(func){var p;return func.length?eval("p = (function proxy("+vars.substring(0,2*func.length-1)+") { return p.invoke(func, this, slice.call(arguments)); });"):p=function(){return p.invoke(func,this,slice.call(arguments))},p}function delegateToCalls(i,o,s,a){spyApi[i]=function(){if(!this.called)return!!a&&a.apply(this,arguments);for(var t,e=0,n=0,r=this.callCount;n<r;n+=1)if((t=this.getCall(n))[s||i].apply(t,arguments)&&(e+=1,o))return!0;return e===this.callCount}}}("object"==typeof sinon&&sinon||null),function(a){var t="undefined"!=typeof module&&module.exports;if(!a&&t&&(a=require("../sinon")),a){var e,n=Array.prototype.slice,l=Array.prototype.join,c="object"==typeof process&&"function"==typeof process.nextTick?process.nextTick:"function"==typeof setImmediate?setImmediate:function(t){setTimeout(t,0)};for(var r in e={create:function(t){var e=a.extend({},a.behavior);return delete e.create,e.stub=t,e},isPresent:function(){return"number"==typeof this.callArgAt||this.exception||"number"==typeof this.returnArgAt||this.returnThis||this.returnValueDefined},invoke:function(t,e){if(o(this,e),this.exception)throw this.exception;return"number"==typeof this.returnArgAt?e[this.returnArgAt]:this.returnThis?t:this.returnValue},onCall:function(t){return this.stub.onCall(t)},onFirstCall:function(){return this.stub.onFirstCall()},onSecondCall:function(){return this.stub.onSecondCall()},onThirdCall:function(){return this.stub.onThirdCall()},withArgs:function(){throw new Error('Defining a stub by invoking "stub.onCall(...).withArgs(...)" is not supported. Use "stub.withArgs(...).onCall(...)" to define sequential behavior for calls with certain arguments.')},callsArg:function(t){if("number"!=typeof t)throw new TypeError("argument index is not number");return this.callArgAt=t,this.callbackArguments=[],this.callbackContext=void 0,this.callArgProp=void 0,this.callbackAsync=!1,this},callsArgOn:function(t,e){if("number"!=typeof t)throw new TypeError("argument index is not number");if("object"!=typeof e)throw new TypeError("argument context is not an object");return this.callArgAt=t,this.callbackArguments=[],this.callbackContext=e,this.callArgProp=void 0,this.callbackAsync=!1,this},callsArgWith:function(t){if("number"!=typeof t)throw new TypeError("argument index is not number");return this.callArgAt=t,this.callbackArguments=n.call(arguments,1),this.callbackContext=void 0,this.callArgProp=void 0,this.callbackAsync=!1,this},callsArgOnWith:function(t,e){if("number"!=typeof t)throw new TypeError("argument index is not number");if("object"!=typeof e)throw new TypeError("argument context is not an object");return this.callArgAt=t,this.callbackArguments=n.call(arguments,2),this.callbackContext=e,this.callArgProp=void 0,this.callbackAsync=!1,this},yields:function(){return this.callArgAt=-1,this.callbackArguments=n.call(arguments,0),this.callbackContext=void 0,this.callArgProp=void 0,this.callbackAsync=!1,this},yieldsOn:function(t){if("object"!=typeof t)throw new TypeError("argument context is not an object");return this.callArgAt=-1,this.callbackArguments=n.call(arguments,1),this.callbackContext=t,this.callArgProp=void 0,this.callbackAsync=!1,this},yieldsTo:function(t){return this.callArgAt=-1,this.callbackArguments=n.call(arguments,1),this.callbackContext=void 0,this.callArgProp=t,this.callbackAsync=!1,this},yieldsToOn:function(t,e){if("object"!=typeof e)throw new TypeError("argument context is not an object");return this.callArgAt=-1,this.callbackArguments=n.call(arguments,2),this.callbackContext=e,this.callArgProp=t,this.callbackAsync=!1,this},throws:i,throwsException:i,returns:function(t){return this.returnValue=t,this.returnValueDefined=!0,this},returnsArg:function(t){if("number"!=typeof t)throw new TypeError("argument index is not number");return this.returnArgAt=t,this},returnsThis:function(){return this.returnThis=!0,this}})e.hasOwnProperty(r)&&r.match(/^(callsArg|yields)/)&&!r.match(/Async/)&&(e[r+"Async"]=function(e){return function(){var t=this[e].apply(this,arguments);return this.callbackAsync=!0,t}}(r));t?module.exports=e:a.behavior=e}function i(t,e){return"string"==typeof t?(this.exception=new Error(e||""),this.exception.name=t):this.exception=t||new Error("Error"),this}function o(t,e){if("number"==typeof t.callArgAt){var n=function(t,e){var n=t.callArgAt;if(n<0){for(var r=t.callArgProp,i=0,o=e.length;i<o;++i){if(!r&&"function"==typeof e[i])return e[i];if(r&&e[i]&&"function"==typeof e[i][r])return e[i][r]}return null}return e[n]}(t,e);if("function"!=typeof n)throw new TypeError((i=n,o=e,(r=t).callArgAt<0?(s=r.callArgProp?a.functionName(r.stub)+" expected to yield to '"+r.callArgProp+"', but no object with such a property was passed.":a.functionName(r.stub)+" expected to yield, but no callback was passed.",0<o.length&&(s+=" Received ["+l.call(o,", ")+"]"),s):"argument at index "+r.callArgAt+" is not a function: "+i));t.callbackAsync?c(function(){n.apply(t.callbackContext,t.callbackArguments)}):n.apply(t.callbackContext,t.callbackArguments)}var r,i,o,s}}("object"==typeof sinon&&sinon||null),function(o){var t="undefined"!=typeof module&&module.exports;if(!o&&t&&(o=require("../sinon")),o){var n=0;o.extend(s,function(){var t={create:function(){var t=function(){return i(t).invoke(this,arguments)};t.id="stub#"+n++;var e=t;return(t=o.spy.create(t)).func=e,o.extend(t,s),t._create=o.stub.create,t.displayName="stub",t.toString=o.functionToString,t.defaultBehavior=null,t.behaviors=[],t},resetBehavior:function(){var t;if(this.defaultBehavior=null,this.behaviors=[],delete this.returnValue,delete this.returnArgAt,this.returnThis=!1,this.fakes)for(t=0;t<this.fakes.length;t++)this.fakes[t].resetBehavior()},onCall:function(t){return this.behaviors[t]||(this.behaviors[t]=o.behavior.create(this)),this.behaviors[t]},onFirstCall:function(){return this.onCall(0)},onSecondCall:function(){return this.onCall(1)},onThirdCall:function(){return this.onCall(2)}};for(var e in o.behavior)o.behavior.hasOwnProperty(e)&&!t.hasOwnProperty(e)&&"create"!=e&&"withArgs"!=e&&"invoke"!=e&&(t[e]=function(t){return function(){return this.defaultBehavior=this.defaultBehavior||o.behavior.create(this),this.defaultBehavior[t].apply(this.defaultBehavior,arguments),this}}(e));return t}()),t?module.exports=s:o.stub=s}function s(t,e,n){if(n&&"function"!=typeof n)throw new TypeError("Custom stub should be function");var r;if(r=n?o.spy&&o.spy.create?o.spy.create(n):n:s.create(),!t&&void 0===e)return o.stub.create();if(void 0===e&&"object"==typeof t){for(var i in t)"function"==typeof t[i]&&s(t,i);return t}return o.wrapMethod(t,e,r)}function r(t){return t.defaultBehavior||(e=t).parent&&i(e.parent)||o.behavior.create(t);var e}function i(t){var e=t.behaviors[t.callCount-1];return e&&e.isPresent()?e:r(t)}}("object"==typeof sinon&&sinon||null),function(c){var n,t="undefined"!=typeof module&&module.exports,u=[].push;if(!c&&t&&(c=require("../sinon")),c){!(n=c.match)&&t&&(n=require("./match")),c.mock=r,c.extend(r,function(){function i(t,e){if(t)for(var n=0,r=t.length;n<r;n+=1)e(t[n])}return{create:function(t){if(!t)throw new TypeError("object is null");var e=c.extend({},r);return e.object=t,delete e.create,e},expects:function(t){if(!t)throw new TypeError("method is falsy");if(this.expectations||(this.expectations={},this.proxies=[]),!this.expectations[t]){this.expectations[t]=[];var e=this;c.wrapMethod(this.object,t,function(){return e.invokeMethod(t,this,arguments)}),u.call(this.proxies,t)}var n=c.expectation.create(t);return u.call(this.expectations[t],n),n},restore:function(){var e=this.object;i(this.proxies,function(t){"function"==typeof e[t].restore&&e[t].restore()})},verify:function(){var e=this.expectations||{},n=[],r=[];return i(this.proxies,function(t){i(e[t],function(t){t.met()?u.call(r,t.toString()):u.call(n,t.toString())})}),this.restore(),0<n.length?c.expectation.fail(n.concat(r).join("\n")):c.expectation.pass(n.concat(r).join("\n")),!0},invokeMethod:function(t,e,n){var r,i=this.expectations&&this.expectations[t],o=i&&i.length||0;for(r=0;r<o;r+=1)if(!i[r].met()&&i[r].allowsCall(e,n))return i[r].apply(e,n);var s,a=[],l=0;for(r=0;r<o;r+=1)i[r].allowsCall(e,n)?s=s||i[r]:l+=1,u.call(a,"    "+i[r].toString());if(0===l)return s.apply(e,n);a.unshift("Unexpected call: "+c.spyCall.toString.call({proxy:t,args:n})),c.expectation.fail(a.join("\n"))}}}());var s=c.timesInWords;c.expectation=function(){var t=Array.prototype.slice,r=c.spy.invoke;function i(t){return"number"==typeof t.maxCalls&&t.callCount==t.maxCalls}function o(t,e){return!n||!n.isMatcher(t)||t.test(e)}return{minCalls:1,maxCalls:1,create:function(t){var e=c.extend(c.stub.create(),c.expectation);return delete e.create,e.method=t,e},invoke:function(t,e,n){return this.verifyCallAllowed(e,n),r.apply(this,arguments)},atLeast:function(t){if("number"!=typeof t)throw new TypeError("'"+t+"' is not number");return this.limitsSet||(this.maxCalls=null,this.limitsSet=!0),this.minCalls=t,this},atMost:function(t){if("number"!=typeof t)throw new TypeError("'"+t+"' is not number");return this.limitsSet||(this.minCalls=null,this.limitsSet=!0),this.maxCalls=t,this},never:function(){return this.exactly(0)},once:function(){return this.exactly(1)},twice:function(){return this.exactly(2)},thrice:function(){return this.exactly(3)},exactly:function(t){if("number"!=typeof t)throw new TypeError("'"+t+"' is not a number");return this.atLeast(t),this.atMost(t)},met:function(){return!this.failed&&(!("number"==typeof(t=this).minCalls)||t.callCount>=t.minCalls);var t},verifyCallAllowed:function(t,e){if(i(this)&&(this.failed=!0,c.expectation.fail(this.method+" already called "+s(this.maxCalls))),"expectedThis"in this&&this.expectedThis!==t&&c.expectation.fail(this.method+" called with "+t+" as thisValue, expected "+this.expectedThis),"expectedArguments"in this){e||c.expectation.fail(this.method+" received no arguments, expected "+c.format(this.expectedArguments)),e.length<this.expectedArguments.length&&c.expectation.fail(this.method+" received too few arguments ("+c.format(e)+"), expected "+c.format(this.expectedArguments)),this.expectsExactArgCount&&e.length!=this.expectedArguments.length&&c.expectation.fail(this.method+" received too many arguments ("+c.format(e)+"), expected "+c.format(this.expectedArguments));for(var n=0,r=this.expectedArguments.length;n<r;n+=1)o(this.expectedArguments[n],e[n])||c.expectation.fail(this.method+" received wrong arguments "+c.format(e)+", didn't match "+this.expectedArguments.toString()),c.deepEqual(this.expectedArguments[n],e[n])||c.expectation.fail(this.method+" received wrong arguments "+c.format(e)+", expected "+c.format(this.expectedArguments))}},allowsCall:function(t,e){if(this.met()&&i(this))return!1;if("expectedThis"in this&&this.expectedThis!==t)return!1;if(!("expectedArguments"in this))return!0;if((e=e||[]).length<this.expectedArguments.length)return!1;if(this.expectsExactArgCount&&e.length!=this.expectedArguments.length)return!1;for(var n=0,r=this.expectedArguments.length;n<r;n+=1){if(!o(this.expectedArguments[n],e[n]))return!1;if(!c.deepEqual(this.expectedArguments[n],e[n]))return!1}return!0},withArgs:function(){return this.expectedArguments=t.call(arguments),this},withExactArgs:function(){return this.withArgs.apply(this,arguments),this.expectsExactArgCount=!0,this},on:function(t){return this.expectedThis=t,this},toString:function(){var t=(this.expectedArguments||[]).slice();this.expectsExactArgCount||u.call(t,"[...]");var e,n=c.spyCall.toString.call({proxy:this.method||"anonymous mock expectation",args:t}).replace(", [...","[, ...")+" "+function(t){var e=t.minCalls,n=t.maxCalls;if("number"==typeof e&&"number"==typeof n){var r=s(e);return e!=n&&(r="at least "+r+" and at most "+s(n)),r}return"number"==typeof e?"at least "+s(e):"at most "+s(n)}(this);return this.met()?"Expectation met: "+n:"Expected "+n+" ("+(0==(e=this.callCount)?"never called":"called "+s(e))+")"},verify:function(){return this.met()?c.expectation.pass(this.toString()):c.expectation.fail(this.toString()),!0},pass:function(t){c.assert.pass(t)},fail:function(t){var e=new Error(t);throw e.name="ExpectationError",e}}}(),t?module.exports=r:c.mock=r}function r(t){return t?r.create(t):c.expectation.create("Anonymous mock")}}("object"==typeof sinon&&sinon||null),function(s){var t="undefined"!=typeof module&&module.exports,e=[].push,a=Object.prototype.hasOwnProperty;if(!s&&t&&(s=require("../sinon")),s){var n={verify:function(){r(this,"verify")},restore:function(){r(this,"restore"),function(t){for(var e=o(t);0<e.length;)e.splice(0,1)}(this)},verifyAndRestore:function(){var e;try{this.verify()}catch(t){e=t}if(this.restore(),e)throw e},add:function(t){return e.call(o(this),t),t},spy:function(){return this.add(s.spy.apply(s,arguments))},stub:function(t,e,n){if(e){var r=t[e];if("function"!=typeof r){if(!a.call(t,e))throw new TypeError("Cannot stub non-existent own property "+e);return t[e]=n,this.add({restore:function(){t[e]=r}})}}if(!e&&t&&"object"==typeof t){var i=s.stub.apply(s,arguments);for(var o in i)"function"==typeof i[o]&&this.add(i[o]);return i}return this.add(s.stub.apply(s,arguments))},mock:function(){return this.add(s.mock.apply(s,arguments))},inject:function(t){var e=this;return t.spy=function(){return e.spy.apply(e,arguments)},t.stub=function(){return e.stub.apply(e,arguments)},t.mock=function(){return e.mock.apply(e,arguments)},t}};t?module.exports=n:s.collection=n}function o(t){return t.fakes||(t.fakes=[]),t.fakes}function r(t,e){for(var n=o(t),r=0,i=n.length;r<i;r+=1)"function"==typeof n[r][e]&&n[r][e]()}}("object"==typeof sinon&&sinon||null),void 0===sinon)var sinon={};if(function(global){var id=1,El;function addTimer(t,e){if(0===t.length)throw new Error("Function requires at least 1 parameter");if(void 0===t[0])throw new Error("Callback must be provided to timer calls");var n=id++,r=t[1]||0;return this.timeouts||(this.timeouts={}),this.timeouts[n]={id:n,func:t[0],callAt:this.now+r,invokeArgs:Array.prototype.slice.call(t,2)},!0===e&&(this.timeouts[n].interval=r),n}function parseTime(t){if(!t)return 0;var e,n=t.split(":"),r=n.length,i=r,o=0;if(3<r||!/^(\d\d:){0,2}\d\d?$/.test(t))throw new Error("tick only understands numbers and 'h:m:s'");for(;i--;){if(60<=(e=parseInt(n[i],10)))throw new Error("Invalid time "+t);o+=e*Math.pow(60,r-i-1)}return 1e3*o}function createObject(t){var e;if(Object.create)e=Object.create(t);else{var n=function(){};n.prototype=t,e=new n}return e.Date.clock=e}function mirrorDateProperties(t,e){for(var n in e.now?t.now=function(){return t.clock.now}:delete t.now,e.toSource?t.toSource=function(){return e.toSource()}:delete t.toSource,t.toString=function(){return e.toString()},t.prototype=e.prototype,t.parse=e.parse,t.UTC=e.UTC,t.prototype.toUTCString=e.prototype.toUTCString,e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}sinon.clock={now:0,create:function(t){var e=createObject(this);if("number"==typeof t&&(e.now=t),t&&"object"==typeof t)throw new TypeError("now should be milliseconds since UNIX epoch");return e},setTimeout:function(t,e){return addTimer.call(this,arguments,!1)},clearTimeout:function(t){this.timeouts||(this.timeouts=[]),t in this.timeouts&&delete this.timeouts[t]},setInterval:function(t,e){return addTimer.call(this,arguments,!0)},clearInterval:function(t){this.clearTimeout(t)},setImmediate:function(t){var e=Array.prototype.slice.call(arguments,1);return addTimer.call(this,[t,0].concat(e),!1)},clearImmediate:function(t){this.clearTimeout(t)},tick:function(t){t="number"==typeof t?t:parseTime(t);for(var e,n=this.now,r=this.now+t,i=this.now,o=this.firstTimerInRange(n,r);o&&n<=r;){if(this.timeouts[o.id]){n=this.now=o.callAt;try{this.callTimer(o)}catch(t){e=e||t}}o=this.firstTimerInRange(i,r),i=n}if(this.now=r,e)throw e;return this.now},firstTimerInRange:function(t,e){var n,r=null;for(var i in this.timeouts)if(this.timeouts.hasOwnProperty(i)){if(this.timeouts[i].callAt<t||this.timeouts[i].callAt>e)continue;(null===r||this.timeouts[i].callAt<r)&&(this.timeouts[i],r=this.timeouts[i].callAt,n={func:this.timeouts[i].func,callAt:this.timeouts[i].callAt,interval:this.timeouts[i].interval,id:this.timeouts[i].id,invokeArgs:this.timeouts[i].invokeArgs})}return n||null},callTimer:function(timer){"number"==typeof timer.interval?this.timeouts[timer.id].callAt+=timer.interval:delete this.timeouts[timer.id];try{"function"==typeof timer.func?timer.func.apply(null,timer.invokeArgs):eval(timer.func)}catch(t){var exception=t}if(this.timeouts[timer.id]){if(exception)throw exception}else if(exception)throw exception},reset:function(){this.timeouts={}},Date:(El=Date,mirrorDateProperties(function t(e,n,r,i,o,s,a){switch(arguments.length){case 0:return new El(t.clock.now);case 1:return new El(e);case 2:return new El(e,n);case 3:return new El(e,n,r);case 4:return new El(e,n,r,i);case 5:return new El(e,n,r,i,o);case 6:return new El(e,n,r,i,o,s);default:return new El(e,n,r,i,o,s,a)}},El))};var methods=["Date","setTimeout","setInterval","clearTimeout","clearInterval"];function restore(){for(var t,e=0,n=this.methods.length;e<n;e++)if(t=this.methods[e],global[t].hadOwnProperty)global[t]=this["_"+t];else try{delete global[t]}catch(t){}this.methods=[]}function stubGlobal(t,e){if(e[t].hadOwnProperty=Object.prototype.hasOwnProperty.call(global,t),e["_"+t]=global[t],"Date"==t){var n=mirrorDateProperties(e[t],global[t]);global[t]=n}else for(var r in global[t]=function(){return e[t].apply(e,arguments)},e[t])e[t].hasOwnProperty(r)&&(global[t][r]=e[t][r]);global[t].clock=e}void 0!==global.setImmediate&&methods.push("setImmediate"),void 0!==global.clearImmediate&&methods.push("clearImmediate"),sinon.useFakeTimers=function(t){var e=sinon.clock.create(t);e.restore=restore,e.methods=Array.prototype.slice.call(arguments,"number"==typeof t?1:0),0===e.methods.length&&(e.methods=methods);for(var n=0,r=e.methods.length;n<r;n++)stubGlobal(e.methods[n],e);return e}}("undefined"!=typeof global&&"function"!=typeof global?global:this),sinon.timers={setTimeout:setTimeout,clearTimeout:clearTimeout,setImmediate:"undefined"!=typeof setImmediate?setImmediate:void 0,clearImmediate:"undefined"!=typeof clearImmediate?clearImmediate:void 0,setInterval:setInterval,clearInterval:clearInterval,Date:Date},"undefined"!=typeof module&&module.exports&&(module.exports=sinon),void 0===sinon&&(this.sinon={}),em=[].push,sinon.Event=function(t,e,n,r){this.initEvent(t,e,n,r)},sinon.Event.prototype={initEvent:function(t,e,n,r){this.type=t,this.bubbles=e,this.cancelable=n,this.target=r},stopPropagation:function(){},preventDefault:function(){this.defaultPrevented=!0}},sinon.EventTarget={addEventListener:function(t,e){this.eventListeners=this.eventListeners||{},this.eventListeners[t]=this.eventListeners[t]||[],em.call(this.eventListeners[t],e)},removeEventListener:function(t,e){for(var n=this.eventListeners&&this.eventListeners[t]||[],r=0,i=n.length;r<i;++r)if(n[r]==e)return n.splice(r,1)},dispatchEvent:function(t){for(var e=t.type,n=this.eventListeners&&this.eventListeners[e]||[],r=0;r<n.length;r++)"function"==typeof n[r]?n[r].call(this,t):n[r].handleEvent(t);return!!t.defaultPrevented}},function(e){void 0===sinon&&(e.sinon={});var n="undefined"!=typeof ProgressEvent,r="undefined"!=typeof CustomEvent;sinon.xhr={XMLHttpRequest:e.XMLHttpRequest};var i=sinon.xhr;i.GlobalXMLHttpRequest=e.XMLHttpRequest,i.GlobalActiveXObject=e.ActiveXObject,i.supportsActiveX=void 0!==i.GlobalActiveXObject,i.supportsXHR=void 0!==i.GlobalXMLHttpRequest,i.workingXHR=i.supportsXHR?i.GlobalXMLHttpRequest:!!i.supportsActiveX&&function(){return new i.GlobalActiveXObject("MSXML2.XMLHTTP.3.0")},i.supportsCORS="withCredentials"in new sinon.xhr.GlobalXMLHttpRequest;var o={"Accept-Charset":!0,"Accept-Encoding":!0,Connection:!0,"Content-Length":!0,Cookie:!0,Cookie2:!0,"Content-Transfer-Encoding":!0,Date:!0,Expect:!0,Host:!0,"Keep-Alive":!0,Referer:!0,TE:!0,Trailer:!0,"Transfer-Encoding":!0,Upgrade:!0,"User-Agent":!0,Via:!0};function s(){this.readyState=s.UNSENT,this.requestHeaders={},this.requestBody=null,this.status=0,this.statusText="",this.upload=new a,sinon.xhr.supportsCORS&&(this.withCredentials=!1);var r=this,t=["loadstart","load","abort","loadend"];function e(n){r.addEventListener(n,function(t){var e=r["on"+n];e&&"function"==typeof e&&e(t)})}for(var n=t.length-1;0<=n;n--)e(t[n]);"function"==typeof s.onCreate&&s.onCreate(this)}function a(){this.eventListeners={progress:[],load:[],abort:[],error:[]}}function l(t){if(t.readyState!==s.OPENED)throw new Error("INVALID_STATE_ERR");if(t.sendFlag)throw new Error("INVALID_STATE_ERR")}function c(t,e){if(t)for(var n=0,r=t.length;n<r;n+=1)e(t[n])}a.prototype.addEventListener=function(t,e){this.eventListeners[t].push(e)},a.prototype.removeEventListener=function(t,e){for(var n=this.eventListeners[t]||[],r=0,i=n.length;r<i;++r)if(n[r]==e)return n.splice(r,1)},a.prototype.dispatchEvent=function(t){for(var e,n=this.eventListeners[t.type]||[],r=0;null!=(e=n[r]);r++)e(t)};var u=function(t,e,n){switch(n.length){case 0:return t[e]();case 1:return t[e](n[0]);case 2:return t[e](n[0],n[1]);case 3:return t[e](n[0],n[1],n[2]);case 4:return t[e](n[0],n[1],n[2],n[3]);case 5:return t[e](n[0],n[1],n[2],n[3],n[4])}};s.filters=[],s.addFilter=function(t){this.filters.push(t)};var h=/MSIE 6/;s.defake=function(e,t){var n=new sinon.xhr.workingXHR;c(["open","setRequestHeader","send","abort","getResponseHeader","getAllResponseHeaders","addEventListener","overrideMimeType","removeEventListener"],function(t){e[t]=function(){return u(n,t,arguments)}});var r=function(t){c(t,function(t){try{e[t]=n[t]}catch(t){if(!h.test(navigator.userAgent))throw t}})},i=function(){e.readyState=n.readyState,n.readyState>=s.HEADERS_RECEIVED&&r(["status","statusText"]),n.readyState>=s.LOADING&&r(["responseText"]),n.readyState===s.DONE&&r(["responseXML"]),e.onreadystatechange&&e.onreadystatechange.call(e,{target:e})};if(n.addEventListener){for(var o in e.eventListeners)e.eventListeners.hasOwnProperty(o)&&c(e.eventListeners[o],function(t){n.addEventListener(o,t)});n.addEventListener("readystatechange",i)}else n.onreadystatechange=i;u(n,"open",t)},s.useFilters=!1,sinon.extend(s.prototype,sinon.EventTarget,{async:!0,open:function(t,e,n,r,i){if(this.method=t,this.url=e,this.async="boolean"!=typeof n||n,this.username=r,this.password=i,this.responseText=null,this.responseXML=null,this.requestHeaders={},!(this.sendFlag=!1)===sinon.FakeXMLHttpRequest.useFilters){var o=arguments;if(function(t,e){for(var n=0;n<t.length;n++)if(!0===e(t[n]))return!0;return!1}(s.filters,function(t){return t.apply(this,o)}))return sinon.FakeXMLHttpRequest.defake(this,arguments)}this.readyStateChange(s.OPENED)},readyStateChange:function(t){if(this.readyState=t,"function"==typeof this.onreadystatechange)try{this.onreadystatechange()}catch(t){sinon.logError("Fake XHR onreadystatechange handler",t)}switch(this.dispatchEvent(new sinon.Event("readystatechange")),this.readyState){case s.DONE:this.dispatchEvent(new sinon.Event("load",!1,!1,this)),this.dispatchEvent(new sinon.Event("loadend",!1,!1,this)),this.upload.dispatchEvent(new sinon.Event("load",!1,!1,this)),n&&this.upload.dispatchEvent(new ProgressEvent("progress",{loaded:100,total:100}))}},setRequestHeader:function(t,e){if(l(this),o[t]||/^(Sec-|Proxy-)/.test(t))throw new Error('Refused to set unsafe header "'+t+'"');this.requestHeaders[t]?this.requestHeaders[t]+=","+e:this.requestHeaders[t]=e},setResponseHeaders:function(t){for(var e in this.responseHeaders={},t)t.hasOwnProperty(e)&&(this.responseHeaders[e]=t[e]);this.async?this.readyStateChange(s.HEADERS_RECEIVED):this.readyState=s.HEADERS_RECEIVED},send:function(t){if(l(this),!/^(get|head)$/i.test(this.method)){if(this.requestHeaders["Content-Type"]){var e=this.requestHeaders["Content-Type"].split(";");this.requestHeaders["Content-Type"]=e[0]+";charset=utf-8"}else this.requestHeaders["Content-Type"]="text/plain;charset=utf-8";this.requestBody=t}this.errorFlag=!1,this.sendFlag=this.async,this.readyStateChange(s.OPENED),"function"==typeof this.onSend&&this.onSend(this),this.dispatchEvent(new sinon.Event("loadstart",!1,!1,this))},abort:function(){this.aborted=!0,this.responseText=null,this.errorFlag=!0,this.requestHeaders={},this.readyState>sinon.FakeXMLHttpRequest.UNSENT&&this.sendFlag&&(this.readyStateChange(sinon.FakeXMLHttpRequest.DONE),this.sendFlag=!1),this.readyState=sinon.FakeXMLHttpRequest.UNSENT,this.dispatchEvent(new sinon.Event("abort",!1,!1,this)),this.upload.dispatchEvent(new sinon.Event("abort",!1,!1,this)),"function"==typeof this.onerror&&this.onerror()},getResponseHeader:function(t){if(this.readyState<s.HEADERS_RECEIVED)return null;if(/^Set-Cookie2?$/i.test(t))return null;for(var e in t=t.toLowerCase(),this.responseHeaders)if(e.toLowerCase()==t)return this.responseHeaders[e];return null},getAllResponseHeaders:function(){if(this.readyState<s.HEADERS_RECEIVED)return"";var t="";for(var e in this.responseHeaders)this.responseHeaders.hasOwnProperty(e)&&!/^Set-Cookie2?$/i.test(e)&&(t+=e+": "+this.responseHeaders[e]+"\r\n");return t},setResponseBody:function(t){!function(t){if(t.readyState==s.DONE)throw new Error("Request done")}(this),function(t){if(t.async&&t.readyState!=s.HEADERS_RECEIVED)throw new Error("No headers received")}(this),function(t){if("string"!=typeof t){var e=new Error("Attempted to respond to fake XMLHttpRequest with "+t+", which is not a string.");throw e.name="InvalidBodyException",e}}(t);var e=this.chunkSize||10,n=0;for(this.responseText="";this.async&&this.readyStateChange(s.LOADING),this.responseText+=t.substring(n,n+e),(n+=e)<t.length;);var r=this.getResponseHeader("Content-Type");if(this.responseText&&(!r||/(text\/xml)|(application\/xml)|(\+xml)/.test(r)))try{this.responseXML=s.parseXML(this.responseText)}catch(t){}this.async?this.readyStateChange(s.DONE):this.readyState=s.DONE},respond:function(t,e,n){this.status="number"==typeof t?t:200,this.statusText=s.statusCodes[this.status],this.setResponseHeaders(e||{}),this.setResponseBody(n||"")},uploadProgress:function(t){n&&this.upload.dispatchEvent(new ProgressEvent("progress",t))},uploadError:function(t){r&&this.upload.dispatchEvent(new CustomEvent("error",{detail:t}))}}),sinon.extend(s,{UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4}),s.parseXML=function(t){var e;"undefined"!=typeof DOMParser?e=(new DOMParser).parseFromString(t,"text/xml"):((e=new ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(t));return e},s.statusCodes={100:"Continue",101:"Switching Protocols",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",300:"Multiple Choice",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported"},sinon.useFakeXMLHttpRequest=function(){return sinon.FakeXMLHttpRequest.restore=function(t){i.supportsXHR&&(e.XMLHttpRequest=i.GlobalXMLHttpRequest),i.supportsActiveX&&(e.ActiveXObject=i.GlobalActiveXObject),delete sinon.FakeXMLHttpRequest.restore,!0!==t&&delete sinon.FakeXMLHttpRequest.onCreate},i.supportsXHR&&(e.XMLHttpRequest=sinon.FakeXMLHttpRequest),i.supportsActiveX&&(e.ActiveXObject=function(t){return"Microsoft.XMLHTTP"==t||/^Msxml2\.XMLHTTP/i.test(t)?new sinon.FakeXMLHttpRequest:new i.GlobalActiveXObject(t)}),sinon.FakeXMLHttpRequest},sinon.FakeXMLHttpRequest=s}("object"==typeof global?global:this),"undefined"!=typeof module&&module.exports&&(module.exports=sinon),void 0===sinon)var sinon={};if(sinon.fakeServer=function(){var r=[].push;function t(){}function i(t){var e=t;if("[object Array]"!=Object.prototype.toString.call(t)&&(e=[200,{},t]),"string"!=typeof e[2])throw new TypeError("Fake server response body should be string, but was "+typeof e[2]);return e}var e="undefined"!=typeof window?window.location:{},f=new RegExp("^"+e.protocol+"//"+e.host);function s(t,e){var n,r,i,o,s,a,l,c=e.url;if(/^https?:\/\//.test(c)&&!f.test(c)||(c=c.replace(f,"")),n=t,r=this.getHTTPMethod(e),i=c,o=n.method,s=!o||o.toLowerCase()==r.toLowerCase(),a=n.url,l=!a||a==i||"function"==typeof a.test&&a.test(i),s&&l){if("function"==typeof t.response){var u=t.url,h=[e].concat(u&&"function"==typeof u.exec?u.exec(c).slice(1):[]);return t.response.apply(t,h)}return!0}return!1}return{create:function(){var e=(t.prototype=this,new t);return this.xhr=sinon.useFakeXMLHttpRequest(),e.requests=[],this.xhr.onCreate=function(t){e.addRequest(t)},e},addRequest:function(t){var e=this;r.call(this.requests,t),t.onSend=function(){e.handleRequest(this),e.autoRespond&&!e.responding&&(setTimeout(function(){e.responding=!1,e.respond()},e.autoRespondAfter||10),e.responding=!0)}},getHTTPMethod:function(t){if(this.fakeHTTPMethods&&/post/i.test(t.method)){var e=(t.requestBody||"").match(/_method=([^\b;]+)/);return e?e[1]:t.method}return t.method},handleRequest:function(t){t.async?(this.queue||(this.queue=[]),r.call(this.queue,t)):this.processRequest(t)},respondWith:function(t,e,n){1!=arguments.length||"function"==typeof t?(this.responses||(this.responses=[]),1==arguments.length&&(n=t,e=t=null),2==arguments.length&&(n=e,e=t,t=null),r.call(this.responses,{method:t,url:e,response:"function"==typeof n?n:i(n)})):this.response=i(t)},respond:function(){0<arguments.length&&this.respondWith.apply(this,arguments);for(var t,e=(this.queue||[]).splice(0);t=e.shift();)this.processRequest(t)},processRequest:function(t){try{if(t.aborted)return;var e=this.response||[404,{},""];if(this.responses)for(var n=this.responses.length-1;0<=n;n--)if(s.call(this,this.responses[n],t)){e=this.responses[n].response;break}4!=t.readyState&&(r=e,i=t,o="Request:\n"+sinon.format(i)+"\n\n",o+="Response:\n"+sinon.format(r)+"\n\n",sinon.log(o),t.respond(e[0],e[1],e[2]))}catch(t){sinon.logError("Fake server request processing",t)}var r,i,o},restore:function(){return this.xhr.restore&&this.xhr.restore.apply(this.xhr,arguments)}}}(),"undefined"!=typeof module&&module.exports&&(module.exports=sinon),function(){function t(){}t.prototype=sinon.fakeServer,sinon.fakeServerWithClock=new t,sinon.fakeServerWithClock.addRequest=function(t){if(t.async&&("object"==typeof setTimeout.clock?this.clock=setTimeout.clock:(this.clock=sinon.useFakeTimers(),this.resetClock=!0),!this.longestTimeout)){var n=this.clock.setTimeout,r=this.clock.setInterval,i=this;this.clock.setTimeout=function(t,e){return i.longestTimeout=Math.max(e,i.longestTimeout||0),n.apply(this,arguments)},this.clock.setInterval=function(t,e){return i.longestTimeout=Math.max(e,i.longestTimeout||0),r.apply(this,arguments)}}return sinon.fakeServer.addRequest.call(this,t)},sinon.fakeServerWithClock.respond=function(){var t=sinon.fakeServer.respond.apply(this,arguments);return this.clock&&(this.clock.tick(this.longestTimeout||0),this.longestTimeout=0,this.resetClock&&(this.clock.restore(),this.resetClock=!1)),t},sinon.fakeServerWithClock.restore=function(){return this.clock&&this.clock.restore(),sinon.fakeServer.restore.apply(this,arguments)}}(),"undefined"!=typeof module&&module.exports){var sinon=require("../sinon");sinon.extend(sinon,require("./util/fake_timers"))}return function(){var i=[].push;function c(t,e,n,r){r&&(!e.injectInto||n in e.injectInto?i.call(t.args,r):e.injectInto[n]=r)}sinon.sandbox=sinon.extend(sinon.create(sinon.collection),{useFakeTimers:function(){return this.clock=sinon.useFakeTimers.apply(sinon,arguments),this.add(this.clock)},serverPrototype:sinon.fakeServer,useFakeServer:function(){var t=this.serverPrototype||sinon.fakeServer;return t&&t.create?(this.server=t.create(),this.add(this.server)):null},inject:function(t){return sinon.collection.inject.call(this,t),this.clock&&(t.clock=this.clock),this.server&&(t.server=this.server,t.requests=this.server.requests),t},create:function(t){if(!t)return sinon.create(sinon.sandbox);var e,n,r=(e=t,n=sinon.create(sinon.sandbox),e.useFakeServer&&("object"==typeof e.useFakeServer&&(n.serverPrototype=e.useFakeServer),n.useFakeServer()),e.useFakeTimers&&("object"==typeof e.useFakeTimers?n.useFakeTimers.apply(n,e.useFakeTimers):n.useFakeTimers()),n);r.args=r.args||[];var i,o,s=r.inject({});if(t.properties)for(var a=0,l=t.properties.length;a<l;a++)c(r,t,i=t.properties[a],o=s[i]||"sandbox"==i&&r);else c(r,t,"sandbox",o);return r}}),sinon.sandbox.useFakeXMLHttpRequest=sinon.sandbox.useFakeServer,"undefined"!=typeof module&&module.exports&&(module.exports=sinon.sandbox)}(),function(s){var t="undefined"!=typeof module&&module.exports;function e(o){var t=typeof o;if("function"!=t)throw new TypeError("sinon.test needs to wrap a test function, got "+t);return function(){var t=s.getConfig(s.config);t.injectInto=t.injectIntoThis&&this||t.injectInto;var e,n,r=s.sandbox.create(t),i=Array.prototype.slice.call(arguments).concat(r.args);try{n=o.apply(this,i)}catch(t){e=t}if(void 0!==e)throw r.restore(),e;return r.verifyAndRestore(),n}}!s&&t&&(s=require("../sinon")),s&&(e.config={injectIntoThis:!0,injectInto:null,properties:["spy","stub","mock","clock","server","requests"],useFakeTimers:!0,useFakeServer:!0},t?module.exports=e:s.test=e)}("object"==typeof sinon&&sinon||null),function(c){var t="undefined"!=typeof module&&module.exports;function u(n,r,i){return function(){var e,t;r&&r.apply(this,arguments);try{t=n.apply(this,arguments)}catch(t){e=t}if(i&&i.apply(this,arguments),e)throw e;return t}}function e(t,e){if(!t||"object"!=typeof t)throw new TypeError("sinon.testCase needs an object with test functions");e=e||"test";var n,r,i,o=new RegExp("^"+e),s={},a=t.setUp,l=t.tearDown;for(n in t)if(t.hasOwnProperty(n)){if(r=t[n],/^(setUp|tearDown)$/.test(n))continue;"function"==typeof r&&o.test(n)?(i=r,(a||l)&&(i=u(r,a,l)),s[n]=c.test(i)):s[n]=t[n]}return s}!c&&t&&(c=require("../sinon")),c&&Object.prototype.hasOwnProperty&&(t?module.exports=e:c.testCase=e)}("object"==typeof sinon&&sinon||null),function(i,n){var o,t="undefined"!=typeof module&&module.exports,s=Array.prototype.slice;function a(){for(var t,e=0,n=arguments.length;e<n;++e)(t=arguments[e])||o.fail("fake is not a spy"),"function"!=typeof t&&o.fail(t+" is not a function"),"function"!=typeof t.getCall&&o.fail(t+" is not stubbed")}function l(t,e){((t=t||n).fail||o.fail).call(t,e)}function e(n,r,i){2==arguments.length&&(i=r,r=n),o[n]=function(t){a(t);var e=s.call(arguments,1);("function"==typeof r?!r(t):"function"==typeof t[r]?!t[r].apply(t,e):!t[r])?l(this,t.printf.apply(t,[i].concat(e))):o.pass(n)}}!i&&t&&(i=require("../sinon")),i&&(o={failException:"AssertError",fail:function(t){var e=new Error(t);throw e.name=this.failException||o.failException,e},pass:function(t){},callOrder:function(){a.apply(null,arguments);var t="",e="";if(i.calledInOrder(arguments))o.pass("callOrder");else{try{t=[].join.call(arguments,", ");for(var n=s.call(arguments),r=n.length;r;)n[--r].called||n.splice(r,1);e=i.orderByFirstCall(n).join(", ")}catch(t){}l(this,"expected "+t+" to be called in order but were called as "+e)}},callCount:function(t,e){if(a(t),t.callCount!=e){var n="expected %n to be called "+i.timesInWords(e)+" but was called %c%C";l(this,t.printf(n))}else o.pass("callCount")},expose:function(t,e){if(!t)throw new TypeError("target is null or undefined");var n,r,i=e||{},o=void 0===i.prefix?"assert":i.prefix,s=void 0===i.includeFail||!!i.includeFail;for(var a in this)"export"==a||!s&&/^(fail)/.test(a)||(t[(n=o,r=a,!n||/^fail/.test(r)?r:n+r.slice(0,1).toUpperCase()+r.slice(1))]=this[a]);return t}},e("called","expected %n to have been called at least once but was never called"),e("notCalled",function(t){return!t.called},"expected %n to not have been called but was called %c%C"),e("calledOnce","expected %n to be called once but was called %c%C"),e("calledTwice","expected %n to be called twice but was called %c%C"),e("calledThrice","expected %n to be called thrice but was called %c%C"),e("calledOn","expected %n to be called with %1 as this but was called with %t"),e("alwaysCalledOn","expected %n to always be called with %1 as this but was called with %t"),e("calledWithNew","expected %n to be called with new"),e("alwaysCalledWithNew","expected %n to always be called with new"),e("calledWith","expected %n to be called with arguments %*%C"),e("calledWithMatch","expected %n to be called with match %*%C"),e("alwaysCalledWith","expected %n to always be called with arguments %*%C"),e("alwaysCalledWithMatch","expected %n to always be called with match %*%C"),e("calledWithExactly","expected %n to be called with exact arguments %*%C"),e("alwaysCalledWithExactly","expected %n to always be called with exact arguments %*%C"),e("neverCalledWith","expected %n to never be called with arguments %*%C"),e("neverCalledWithMatch","expected %n to never be called with match %*%C"),e("threw","%n did not throw exception%C"),e("alwaysThrew","%n did not always throw exception%C"),t?module.exports=o:i.assert=o)}("object"==typeof sinon&&sinon||null,"undefined"!=typeof window?window:"undefined"!=typeof self?self:global),sinon}.call("undefined"!=typeof window&&window||{});